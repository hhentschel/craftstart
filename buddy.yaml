- pipeline: "Craftdev: Build & Deploy to Staging"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "develop"
  ref_type: "BRANCH"
  target_site_url: "$PROJECT_URL"
  trigger_condition: "ALWAYS"
  actions:
    - action: "Execute: vite build"
      type: "BUILD"
      working_directory: "/buddy/${PROJECT_SHORTNAME}"
      docker_image_name: "nystudio107/node-dev-base"
      docker_image_tag: "20-alpine"
      execute_commands:
        - "cd buildchain"
        - "npm install"
        - "npm run build"
      volume_mappings:
        - "/:/buddy/${PROJECT_SHORTNAME}"
      trigger_condition: "ALWAYS"
      shell: "SH"
  variables:
    - key: "PROJECT_SHORTNAME"
      value: "craft"
    - key: "PROJECT_URL"
      value: "https://craftdev.henrik.work"
    - key: "REMOTE_PROJECT_ROOT"
      value: "/home/forge/craftdev.henrik.work"
    - key: "REMOTE_SSH_WEB"
      value: "142.93.230.122"
    - key: "REMOTE_SSH_USER"
      value: "forge"